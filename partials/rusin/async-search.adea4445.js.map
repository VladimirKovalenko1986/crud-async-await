{"mappings":"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","sources":["src/js/rusin/async-search.js","src/js/rusin/components/get-refs.js"],"sourcesContent":["import { getRefs } from './components/get-refs';\n\nconst refs = getRefs();\nconst markup = `<input class=\"search-input\" type=\"text\" name=\"country\" />`;\n\nrefs.addCountry.addEventListener('click', handlerAddInput);\n\nfunction handlerAddInput() {\n  refs.conteinerWrapper.insertAdjacentHTML('beforeend', markup);\n}\n\nrefs.searchForm.addEventListener('submit', handlerForm);\n\nfunction handlerForm(e) {\n  e.preventDefault();\n  const data = new FormData(e.currentTarget);\n  const arr = data\n    .getAll('country')\n    .filter(item => item)\n    .map(item => item.trim());\n  getCountry(arr)\n    .then(async resp => {\n      const capitals = resp.map(({ capital }) => capital[0]);\n      const weatherService = await getWeather(capitals);\n      refs.list.innerHTML = createMarkup(weatherService);\n    })\n    .catch(err => console.log(err))\n    .finally(() => {\n      refs.searchForm.reset();\n      refs.conteinerWrapper.innerHTML = markup;\n    });\n}\n\nasync function getCountry(arr) {\n  const resps = arr.map(async item => {\n    const resp = await fetch(`https://restcountries.com/v3.1/name/${item}`);\n    if (!resp.ok) {\n      throw new Error();\n    }\n\n    return resp.json();\n  });\n  const data = await Promise.allSettled(resps);\n  const countryObject = data\n    .filter(({ status }) => status === 'fulfilled')\n    .map(({ value }) => value[0]);\n\n  return countryObject;\n}\n\nasync function getWeather(arr) {\n  const BASE_URL = 'http://api.weatherapi.com/v1';\n  const API_KEY = '9832fca16a6240d9a17162137242801';\n\n  const resps = arr.map(async city => {\n    const params = new URLSearchParams({\n      key: API_KEY,\n      q: city,\n      lang: 'uk',\n    });\n\n    const resp = await fetch(`${BASE_URL}/current.json?${params}`);\n\n    if (!resp.ok) {\n      throw new Error(resp.statusText);\n    }\n    return resp.json();\n  });\n  const data = await Promise.allSettled(resps);\n  const objs = data\n    .filter(({ status }) => status === 'fulfilled')\n    .map(({ value }) => value);\n\n  return objs;\n}\n\nfunction createMarkup(arr) {\n  return arr\n    .map(\n      ({\n        current: {\n          condition: { icon, text },\n          temp_c,\n        },\n        location: { country, name },\n      }) =>\n        ` <li class=\"weather-item\">\n          <div>\n            <h2>${country}</h2>\n            <h3>${name}</h3>\n          </div>\n          <img class=\"weather-img\" src=\"${icon}\" alt=\"${text}\" />\n          <p>${text}</p>\n          <p>${temp_c}Â°C</p>\n        </li>`\n    )\n    .join('');\n}\n","function getRefs() {\n  return {\n    searchForm: document.querySelector('.js-search'),\n    addCountry: document.querySelector('.js-add'),\n    list: document.querySelector('.js-list'),\n    conteinerWrapper: document.querySelector('.js-wrapper'),\n  };\n}\n\nexport { getRefs };\n"],"names":["$bpxeT","parcelRequire","$9029cd97846f36e3$var$refs","searchForm","document","querySelector","addCountry","list","conteinerWrapper","$9029cd97846f36e3$var$markup","$9029cd97846f36e3$var$_getCountry","$parcel$interopDefault","$2TvXO","mark","_callee1","arr","resps","data","countryObject","map","_callee","item","resp","fetch","concat","_ctx","sent","ok","Error","json","Promise","allSettled","_ctx1","filter","param","status","value","apply","this","arguments","$9029cd97846f36e3$var$getWeather","$9029cd97846f36e3$var$_getWeather","_callee2","objs","city","params","URLSearchParams","key","q","lang","statusText","_ctx2","$9029cd97846f36e3$var$createMarkup","current","_condition","_current","condition","icon","text","temp_c","_location","location","country","name","join","addEventListener","insertAdjacentHTML","e","preventDefault","$9029cd97846f36e3$var$getCountry","FormData","currentTarget","getAll","trim","then","capitals","weatherService","capital","innerHTML","catch","err","console","log","finally","reset"],"version":3,"file":"async-search.adea4445.js.map"}